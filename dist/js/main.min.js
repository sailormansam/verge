var Block=function(t,e,i){this.sprite,this.width=i,this.height=i,this.x=t*this.width,this.y=e*this.height,this.create()};Block.prototype={create:function(){var t=game.add.graphics(0,0);t.beginFill(6710886),t.drawRect(0,0,this.width,this.height),this.sprite=game.add.sprite(this.x,this.y,t.generateTexture()),t.destroy(),game.physics.p2.enable(this.sprite),this.sprite.body.dynamic=!1}};var GameStates=GameStates||{},textStyle={normal:{font:"3em squada one",fill:"#333"},large:{font:"6em squada one",fill:"#333"}};GameStates.Boot=function(t){},GameStates.Boot.prototype={init:function(){this.input.maxPointers=1,game.stage.backgroundColor="#ffffff"},create:function(){game.state.start("Preloader")}},GameStates.Game=function(t){this.player=null,this.level=0,this.block=[],this.teleporter,this.map,this.GRAVITY=1e3,this.mapGrain=40},GameStates.Game.prototype={create:function(){game.physics.startSystem(Phaser.Physics.P2JS),game.physics.p2.defaultRestitution=1,game.physics.p2.gravity.y=this.GRAVITY,game.physics.p2.damping=1,this.map=JSON.parse(JSON.stringify(game.cache.getJSON("map"))),this.makeLevel(this.level),game.camera.follow(this.player.sprite)},update:function(){this.player.update(),Phaser.Rectangle.intersects(this.player.sprite.getBounds(),this.teleporter.sprite.getBounds())&&this.map.level[this.level+1]&&this.makeLevel(this.level++)},makeLevel:function(){this.block.forEach(function(t){t.sprite.destroy()}),this.block=[],this.teleporter&&this.teleporter.sprite.destroy(),this.player?this.player.moveToStart(this.map.level[this.level].start.x*this.mapGrain,this.map.level[this.level].start.y*this.mapGrain):this.player=new Player(this.map.level[this.level].start.x*this.mapGrain,this.map.level[this.level].start.y*this.mapGrain);for(var t=0,e=this.map.level[this.level].block.length;e>t;t++)this.block.push(new Block(this.map.level[this.level].block[t].x,this.map.level[this.level].block[t].y,this.mapGrain));this.teleporter=new Teleporter(this.map.level[this.level].teleporter.x,this.map.level[this.level].teleporter.y,this.mapGrain),game.world.setBounds(0,0,this.map.level[this.level].block[t-1].x*this.mapGrain,game.height)}},GameStates.GameOver=function(t){},GameStates.GameOver.prototype={create:function(){}},GameStates.MainMenu=function(t){this.titleText,this.playText},GameStates.MainMenu.prototype={create:function(){this.titleText=game.add.text(.25*game.width,game.world.centerY,"VERGE",textStyle.large),this.titleText.anchor.set(0,.5),this.titleText.alpha=0,this.playText=game.add.text(.25*game.width,.625*game.height,"PLAY",textStyle.normal),this.playText.anchor.set(0,.5),this.playText.alpha=0,game.add.tween(this.titleText).to({alpha:1,x:.2*game.width},500,Phaser.Easing.Quadratic.InOut,!0),game.add.tween(this.playText).to({alpha:1,x:.2*game.width},500,Phaser.Easing.Quadratic.InOut,!0,200),this.playText.inputEnabled=!0,this.playText.input.useHandCursor=!0,this.playText.events.onInputDown.add(this.play,this)},play:function(){game.add.tween(this.titleText).to({alpha:0,x:.15*game.width},500,Phaser.Easing.Quadratic.InOut,!0);var t=game.add.tween(this.playText).to({alpha:0,x:.15*game.width},500,Phaser.Easing.Quadratic.InOut,!0,200);t.onComplete.add(function(){game.state.start("Game")},this)}};var Player=function(t,e){this.sprite,this.x=t,this.y=e,this.width=25,this.height=40,this.SPEED=300,this.JUMP=-450,this.create()};Player.prototype={create:function(){var t=game.add.graphics(0,0);t.beginFill(3355443),t.drawRect(0,0,this.width,this.height),this.sprite=game.add.sprite(this.x,this.y,t.generateTexture()),t.destroy(),game.physics.p2.enable(this.sprite),this.sprite.body.mass=1},update:function(){this.sprite.body.setZeroRotation(),this.sprite.body.rotation=0,this.move()},move:function(){game.input.keyboard.isDown(Phaser.Keyboard.A)||game.input.keyboard.isDown(Phaser.Keyboard.LEFT)?this.sprite.body.velocity.x=-this.SPEED:(game.input.keyboard.isDown(Phaser.Keyboard.D)||game.input.keyboard.isDown(Phaser.Keyboard.RIGHT))&&(this.sprite.body.velocity.x=this.SPEED),(game.input.keyboard.isDown(Phaser.Keyboard.W)||game.input.keyboard.isDown(Phaser.Keyboard.UP))&&(this.sprite.body.velocity.y=this.JUMP)},moveToStart:function(t,e){this.sprite.body.x=t,this.sprite.body.y=e,this.sprite.body.velocity.x=0,this.sprite.body.velocity.y=0}},GameStates.Preloader=function(t){},GameStates.Preloader.prototype={preload:function(){var t=game.add.text(.2*game.width,game.world.centerY,"LOADING",textStyle.large);t.anchor.set(0,.5),game.load.json("map","/map.json")},create:function(){game.state.start("MainMenu")}};var Teleporter=function(t,e,i){this.sprite,this.width=i,this.height=i,this.x=t*this.width,this.y=e*this.height,this.create()};Teleporter.prototype={create:function(){var t=game.add.graphics(0,0);t.beginFill(16711680),t.drawRect(0,0,this.width,this.height),this.sprite=game.add.sprite(this.x,this.y,t.generateTexture()),t.destroy(),this.sprite.anchor.set(.5)}};